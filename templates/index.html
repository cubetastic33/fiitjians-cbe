{% extends 'layout.html' %}

{% block title %}Fiitjians cbe{% endblock %}

{% block body %}
<div id="homePage">
  <div class="section white">
      <div class="row container">
        <h4>Welcome to Fiitjians Cbe!</h4>
        <ul class="collection col s12">
          <li class="collection-item avatar" style="cursor: pointer" onclick="saveIp('9 A1')">
            <img src="images/9.jpg" alt="9th" class="circle">
            <span class="title">Class: Nine A<sub>1</sub></span>
            <p>
              Given by: Aravindan
            </p>
          </li>
          <li class="collection-item avatar" style="cursor: pointer" onclick="saveIp('9 B')">
            <img src="images/9.jpg" alt="9th" class="circle">
            <span class="title">Class: Nine B</span>
            <p>
              Given by: Aditya Radhakrishnan
            </p>
          </li>
          <li class="collection-item avatar" style="cursor: pointer" onclick="saveIp('11 A3')">
            <img src="images/11.svg" alt="11th" class="circle">
            <span class="title">Class: Eleven A<sub>3</sub></span>
            <p>
              Given by: Nirmal Karthikeyan
            </p>
          </li>
          <li class="collection-item avatar">
            <i class="material-icons circle red">add</i>
            <span class="title">Add Your Class</span>
            <p>Is your class not on this list? Contact Aravindan K (9 A<sub>1</sub>) or Aditya R (9 B) to add your class.</p>
          </li>
        </ul>
      </div>
    </div>
</div>
{% endblock %}

{% block javascript %}
<script>
  $.ajax({
    url: '/get_ip_address',
    type: 'POST',
    success: function(response) {
      console.log(response);
      window.ipAddress = response;
    },
    error: function(error) {
      console.log('Error', error);
    }
  });
  function saveIp(className) {
    db.ref('ipAddresses').child(ipAddress.replace(/\./g,' ')).set(className);
    console.log(className);
    db.ref('ipAddresses').on('value', function(data) {
      if (data.child(ipAddress.replace(/\./g,' ')).val() == className) {
        alert('Your class has been set to '+className+' for this IP Address.\
 However, if you get an error on the next page, then come back here and try again.');
        window.location.href = 'timetable.html';
      }
    });
  }
</script>
{% endblock %}